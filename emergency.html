<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Emergency Information</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Roboto', Arial, sans-serif;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, #e0e5ec, #f5f7fa);
    min-height: 100vh;
  }

  .container {
    background: #fff;
    width: 95%;
    max-width: 480px;
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    border: 1px solid #d1d5db;
  }

  h1 { text-align: center; color: #b30000; margin-bottom: 5px; }
  .subtitle { text-align: center; color: #555; font-size: 0.9em; margin-bottom: 20px; }

  .input-wrapper {
    position: relative;
    width: 100%;
    margin-top: 10px;
  }

  .input-wrapper input {
    width: 100%;
    padding: 14px;
    padding-right: 50px;
    font-size: 1em;
    border-radius: 8px;
    border: 1px solid #b0b5bf;
    box-sizing: border-box;
    transition: border-color 0.3s, box-shadow 0.3s;
  }

  .input-wrapper input:focus {
    outline: none;
    border-color: #0052cc;
    box-shadow: 0 0 5px rgba(0,82,204,0.3);
  }

  .input-wrapper .show-hide {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    border: none;
    background: none;
    cursor: pointer;
    font-size: 1.1em;
    color: #555;
  }

  .input-wrapper .show-hide:hover { color: #000; }

  #unlockBtn {
    background-color: #b30000;
    color: white;
    margin-top: 15px;
    font-weight: 600;
    border-radius: 8px;
    border: none;
    padding: 14px;
    font-size: 1.05em;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }

  #unlockBtn:hover {
    background-color: #900000;
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
  }

  #error { color: #d93025; margin-top: 10px; font-weight: bold; text-align: center; }

  .card {
    background: #f9f9f9;
    padding: 20px;
    margin-top: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }

  .card p { margin: 8px 0; line-height: 1.4; }
  .card strong { display: inline-block; width: 140px; }
  .hidden { display: none; }
</style>
</head>

<body>
  <div class="container">
    <h1>Emergency Information</h1>
    <p class="subtitle">Authorised access only</p>

    <div class="input-wrapper">
      <input type="password" id="passphrase" placeholder="Enter passphrase">
      <button type="button" class="show-hide" onclick="togglePassphrase()">üëÅ</button>
    </div>

    <button id="unlockBtn" onclick="unlock()">Unlock</button>
    <p id="error"></p>

    <div id="info" class="hidden card">
      <p><strong>Name:</strong> <span id="name"></span></p>
      <p><strong>Nationality:</strong> <span id="nationality"></span></p>
      <p><strong>Allergies:</strong> <span id="allergies"></span></p>
      <p><strong>Medical Conditions:</strong> <span id="medical"></span></p>
      <p><strong>Medications:</strong> <span id="medications"></span></p>
      <p><strong>Blood Type:</strong> <span id="blood"></span></p>
      <p><strong>Emergency Contact 1:</strong> <span id="contact"></span></p>
      <p><strong>Emergency Contact 2:</strong> <span id="contact2"></span></p>


      <p><strong>Languages:</strong> <span id="languages"></span></p>
    </div>
  </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
const MAX_ATTEMPTS = 4;
const LOCK_TIME_MS = 10*60*1000;

let attempts = 0;
let lockedUntil = null;

// Corrected encrypted array (no extra nesting)
const encryptedArray = [


  {
    "id": "a1b2c3d4",
    "encryptedData": "04c9504ecb61248db92b2f63bce2f196b6dc89b274d4db2271f4509e736aac80399d5df6ec7a1db55c004c5b49a20565596c8accef7d84b1dda34a968c1d4c8eb6b99be62e55fd1b55e166c70f77c11caf40728d4b73fa2164b3914c184b9b50be4f9a692b75652b7182b6b9360f2dd8606111eea7b8cb168043e8fe82670e9c0f3b2ced77cdf5d0d7f5c54976414a74219c817261cff160af3e07c3ef74689118f65b6c09d0649dd2e387710d1c1b7d196f2087af6cfa29ccf48d4dd5a65479406ceaf5697095cabdf6f97a0d7b71a26c9b4143a6108ef3203ad6ae74832c0de4b6944014a80241b2b2b1c5cda6925d2406b3c8657acfabb2a2bf6a0082e97ff5ca20d032316dda919eced1bd9e647e011a3718a82272a1c073a0098fa92cb5"
  },
  {
    "id": "e5f6g7h8",
    "encryptedData": "e40969902578535bdcd2849cfcc4d038884120d2f7eefe92db95de79fa27fe848c7e1f44a5e12146c787793c105f5550032fd826d83f20e41af1f89514ce308b6922773fe17cd1293ddaeb4e637d692748d6cdf6d630c3ce50444c25e8a644a4c0faeafee8545d8436727f011ed5c5d5dc47c234a85c3d351fea596ea31904429d02a5daa2160b41f3145378e780407db5d4430c73e457ebe62effc4454a5d77d2d30692161c24f279514391d7932a3951c09cafb39ea86920640557dfc60ff5e3cf021a7569dbd81737bb59e8e453154035880070b855613537a3a8e8784f9dc354a7eedfcb07a310f18afa92765569ff8c51ed49a63f275205f129ff4c8614487634e625df46441e504f6289de0c08f397bc27030f9856990fc43d45ca896a3afa7a6b6bd1956474ac376715252082"
  },
  {
    "id": "i9j0k1l2",
    "encryptedData": "90751e6f2f35812ff6dcefd424d48aa7d78d5b60033975b4d0c831a7b1368588d19d3b41f275a1a94d49f08ccad7943a6eae16d63508f135dd3b10c1c20eb1c1b869d51bee5e58357f3eb1d379b0a7e5a5b693979aab041c074a3ef3df0a8bad95cb16f8b15091b358d79eabcd03a55c9b59532d7651a1918f30c6b34848c3c2d0225a2e591b93b8b7f6800b920ae2adfd269618101c88534f1055c49d38aa4dd9475fcb6e55b6a690d3e954c2a06510478133b88b877628e36084a6ffe567c47880affda005e7b45844c471624c9f696084b3b2893a4c69641b4998392a71f87fedcca0e8626761a6ab1f0b9217431ce9fd64848c1d36a106e3ab6ac27f6e81f627fb3220d2f0809f91e2cacb94d29e1ef04e171831181c2f7fe6765fb2b64fa55d5870b793d1be46b856d33a0efed4"
  },
  {
    "id": "m3n4o5p6",
    "encryptedData": "6f61ac31354fc0a17e4c9c11b184de283f9783f91861cbc35b39fbcc264ed55294e0a9a0ab6817a9c21d829c7868038e39cfa7957a6abead9a78ba9327a702c6def69d9147cd4062fb2a106b9e0011f3e719cc97f4018231c29c25e5d5d2909f8e03a11ba02032cb9b9889f30762824486a5c9b7519cd7e9a61e1129f52426ed570594f40f1590a6859f805b9627f235cf6452b1af401688c88fc76572368a719ac9f9119b60fcab9db758d16e1d5debd51d60aafe33e1782bc6eeec5ac755f323658b366dfa7d45215f60ac4931f7bd1bdce34632daeb6351d10a7be78d4538feb10079fedf142a4dfe67cd1d1ae03059a46645aa342b5e314566bbab525574848253fe157158e290f534600a83f239"
  },
  {
    "id": "q7r8s9t0",
    "encryptedData": "781528393d33ba4d7d35ac8181be02dac8d49b2add1627dad335bdb54a11762bc457f421804b9212668f7542ce3be94d41a719f7c8f6842ab1d8165955fe47e2eb289c80d6ca64fa2f7db072fd933560d1dbb3785229e08de442b15edd71117d36025ed362d72df6d1e0a09baefd5c6b4fe2314d680b879314bec567349a576f2c670fd66e52c5c59948c9865e8e980f426681322066c4f9618a71411ba6dafe1077832d7ec013e058f2228fcc243d8971a3f275e57c09c25e3cb3d5c0bb4aa4d1761722849da06917e888e0a10875af252029c0358fe06290d4556b825f334ac22469ff275fce6280a760edce7c7b6f8458b5804149554bb09895aca12e0157a3679469a2e30fe27ec0c1181cc9c6315bafaed446b40e64211a932835f112be"
  },
  {
    "id": "u1v2w3x4",
    "encryptedData": "2b546fd02ac0d4a693e624b1ad42f49ee5ee4eb85cf0ea7c3bf1c757699e7aaa0288428648657f10987c66321d2ddcd07abc64691ba290435fb868144d59be6e8f02f5ae8b5c088944eae204484e59e86f07186537c7001378c08e6c431c888389893dc0301c0f49dc6f845d9b9b15cdb8b953bea72b4f62bec5ad7b5a71a58366bcdc6c8a6e5cc8a81923853241d441049d0d96489908a2b8a855270ed88983f8672d71c0c9f9baac4387c3f4f38b88b61a33840a47fd6345b3c9e47d4380e24d8de90426912735ccabc7eee80a248f60d01d918a1f2556414016c184d9574a4bd781845f43d2ddae9cc78e120ba1dc666ad6d143dd6512f0c6aaa30d34f97b41c92d876258b6d5ed44f2efe46474d30bb63167f4cac7423b7a4b3ba27105d0"
  },
  {
    "id": "y5z6a7b8",
    "encryptedData": "e1df57bdd9dc3bad5df17f72d5fe501985a025f8d947bb67dafb23e4271014642d2ace683040a4f1972fd1d149dae52511dfcf16089261b139160c2720347ba077f56492f33ea37bb6b8b0292193fcc14e37cf5fcb62c2ecc1d8bd94f9306ccc050a0f8d9a7b749d3868378228c5589efe9e3e0c40b3b1343d608fe1590859b1b846bc8c889a6729644966c860ff57800677ff7c608a7c0a19b1fbf1108729320c3d0959101efefea2688219cff0323b37482cae1a95698c19e22c6c40ec9eba8c0dac5362b8d96b279888723047abb082ce97313189f82421a2f469725644d77befe6166245ab32285cd3e0b764fe49b851d70caddb28bc626d4c5a6268e30903110d2eab2d524626b095b59e81b1cba67e8d98816aafd0f6e659e467da6a97b1ed559da6f050cf02741886de61547f"
  },
  {
    "id": "c9d0e1f2",
    "encryptedData": "fd331eac2f53d9314c4d8abbae6b28681e64eec62cce1f5484a7ecce9bc88aae9ea50639f822338253f936a3cc1a396ab5c5af5dfb04b669e06977180447d38ac2307f6e2dc8bc7148f72fbeaadca047486ad52a9477401f7b6920aa37e74cd8f96d7fd514353012b765630835e0f4384230b1a15904e4b6259845374c6fcd8e089153fb8be9c5fd23f5cb34f1f4d3da37a4a6ea25292b7b6a109972c349cba4c359dafe5a4cbe8775ecdb317cbc752d0492af7c82767d05439abd3689dc8223d3da866aa4b99c6f89c8f52cbd84f82605b4b9962c6b985d184b0646fa4872271d9067b714639df0761546a69763ccb36d27b74756a93ab6005ed2688e83346f6f6f92900c8be80670766be60f31c6e3f3425b312ce59b8e8578a1d29b0e9ad57bd813b82582d4c0ef8ab960ea8232bf25344d4fe2a7185c964065104638b25eaf1b0d3b2e478594c5a332297880aa85"
  },
  {
    "id": "g3h4i5j6",
    "encryptedData": "5cf0f80332449b42a6df67afb38f73d49e5af1ad2d304751d31b347f10e45d7abd21ac8ae5c8a5d1cbb8318a29d01234015d7548d29a1d98eff4fe11078006de4ac94da810701db357616b4432840256d9b1b17ac4d82f2caae59f730a494145745107d806e7d6a5c5d1289c98557f4afcecd4a1139e1217f100a97d602cdcd6efa19a952788e5970e49238aebadc7831014218a62f50efdca74b1d9b473bd3713fc8124927ded022ee19c098bbdf6230f4318aefab27a6b714bec8a9e55bd73396c9ac7d82a5ce38c863354f39b441fb82ec0b9ada1ebd28e507fa27e69b0c9d6472902fe6e8a8e6a1c0e4484422de22e7e1edc02ce4235f9cac51b27904439012ddd9494c862bf222671e28cc6b80e0c50d4dfcc3de7f77798a33a2ed23d09"
  },
  {
    "id": "k7l8m9n0",
    "encryptedData": "ac078b23a2467cbeee17eeaeaf35ac2bef30859d93300065d641e9090fbdf8886286076e13dfb2ae9f01c439e799cbc19f7b8b2f898e4e076a36c13ae6f9e30cf50d143903765d6aa414600323b2e512a46f88473d8340bc265c919f32340f4deab518cf7ccae824ea3800690f30340504f9f421d6366ecd09d1bd05841811b8e1be54a93ac34b2aa3e50e30f26620685bbb38c597131e360ab5925c073b27180673d8566224aeaad51094705be579d5f0134c5bdfcb44976808e49debd9cd6145bad159c794f2c34461f4cb563cffede1e64c1091a3a9f3ec211c3fa19772911c4749b117b1f491af33868761d3dbe70720371379fc79ae7f6a528a004c47782fd4e4dabcf561ec6d3fe3274ea1517ee7f6fc92df569643813c07c396043b0f"
  },
  {
    "id": "o1p2q3r4",
    "encryptedData": "2ab428afadc6d61fad850f89dc636cbb5a3a50a8baba2fd18335a437978b6fb9ac9ca4bf741ebe60a71803d5a4c211be6568cf72e68dc4802ea866b11a8a9ee0dc3f74be450c8ced12b8957a49ecacef0db11cbdf1caffe1ecd8cfb213732423d4184cd77ec0a70fe0e3a1f947c2e13f84df92cef071fad4051894c3a4852d97d5c7697704c1c02f470278c0a7b34b6b783f3568ab9c95ceeefb9b06e87870dd7fb6212b5829021b5d683bd1e127e995bc3a41435acdd22380857bf4721d9af0e349348778f47feb464438be153d1072c2f9918d879f780d0cd0866384a54aa826fdb8662a5f57d1dc99589a3a92f42232eb8975abd8fbf43a6d33790b3d696bcbc5721993a35929fc57558c4c605bfefce115ed1f04906f454a9c7b73cc4d5b"
  },
  {
    "id": "s5t6u7v8",
    "encryptedData": "278e5cf5c6b92915538eaa98e2ae19e41992a72122a92595617157a6a1335690b1d5f48277ff7f1599769abf1e224903401a08bbf38cedc7b05e4a826911d11f23dfb763b3a0e0ee789130e631d2d6ae4a940dc9070f8bad9b41c6942912003e8038511b06c4a308a801bdc40847d4595101d8242a3218b6e541d8d58d7a0bc79fd1d869afac082796fef9fa13f5e4afdcfe4888dfbaf895df5927bd9fcf16f6aaa4745fa75405d07f2087dd8dbcf99e9ca0415a2e7d1dcc82b2ffa65969490fdc5af871d4361b5e725bd03618d647d93e30a09735ccf432dd2c0b97ea246a1c975f8714d4f81eb8e7b41a3b12a9a498539dc49bab2f63298c0ed63c888f0e670927a10b49f44777fe8d493883145c0083774c1b81a5ce4f7728b475c7347a38"
  }






  
  // ...add the rest here without extra brackets
];

// Convert to an object for easy lookup
const people = {};
encryptedArray.forEach(item => {
  people[item.id.toLowerCase()] = { encrypted: item.encryptedData };
});

// Get ID from URL
const params = new URLSearchParams(window.location.search);
const id = params.get("id")?.toLowerCase();

function togglePassphrase() {
  const input = document.getElementById("passphrase");
  input.type = input.type === "password" ? "text" : "password";
}

function unlock() {
  const passphrase = document.getElementById("passphrase").value;
  const error = document.getElementById("error");

  if (!passphrase) {
    error.textContent = "Enter a passphrase.";
    return;
  }

  if (!id || !people[id]) {
    error.textContent = "Invalid emergency tag.";
    return;
  }

  try {
    const bytes = CryptoJS.AES.decrypt(people[id].encrypted, passphrase);
    const decrypted = bytes.toString(CryptoJS.enc.Utf8);

    if (!decrypted) throw new Error("Wrong passphrase");

    const data = JSON.parse(decrypted);

    document.getElementById("info").classList.remove("hidden");
    document.getElementById("name").textContent = data.name;
    document.getElementById("nationality").textContent = data.nationality;
    document.getElementById("allergies").textContent = data.allergies;
    document.getElementById("medical").textContent = data.medical;
    document.getElementById("medications").textContent = data.medications;
    document.getElementById("blood").textContent = data.blood;
    document.getElementById("contact").textContent = data.contact;
    document.getElementById("contact2").textContent = data.contact2;
    document.getElementById("languages").textContent = data.languages;

    error.textContent = "";
  } catch {
    error.textContent = "Incorrect passphrase.";
  }
}

window.addEventListener("load", () => {
  const field = document.getElementById("passphrase");
  field.focus();
  field.addEventListener("keydown", e => { if(e.key==="Enter") unlock(); });
});
</script>

</body>
</html>
